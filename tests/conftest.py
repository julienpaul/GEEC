#!/usr/bin/env python3
# conftest.py

# --- import -----------------------------------
# import from standard lib
import numpy as np
import pytest

# import from other lib
# import from my project
np.set_printoptions(precision=20)


class Cube:
    def __init__(self):
        self.density = 1000
        self.Gc = 6.67408e-11
        self.obs = np.array([-1.05, -1.05, 0])
        self.points = [
            (-0.5, -0.5, 0.0),
            (0.5, -0.5, 0.0),
            (0.5, 0.5, 0.0),
            (-0.5, 0.5, 0.0),
            (-0.5, -0.5, -1.0),
            (0.5, -0.5, -1.0),
            (0.5, 0.5, -1.0),
            (-0.5, 0.5, -1.0),
        ]

        # Start, End and Step
        x_start, x_end, x_step = -1.05, 1.05, 0.7
        y_start, y_end, y_step = -1.05, 1.05, 0.7
        z_start, z_end, z_step = 0, 1, 1

        g = np.mgrid[x_start:x_end:x_step, y_start:y_end:y_step, z_start:z_end:z_step]

        self.listobs = np.transpose(g.reshape(len(g), -1))


class CubeExcepted:
    def __init__(self):
        # result of obs
        self.G = np.array(
            [0.00183463065681974, 0.0018346306568197504, -0.0008638357043917455]
        )

        # result of listobs
        self.Glistobs = np.array(
            [
                [0.00183463065681974, 0.0018346306568197504, -0.0008638357043917455],
                [0.003951204725618204, 0.0012532924509543325, -0.0018090104337738755],
                [0.003951204725618195, -0.0012532924509543247, -0.0018090104337738677],
                [0.0018346306568197454, -0.0018346306568197482, -0.0008638357043917366],
                [0.0012532924509543247, 0.003951204725618206, -0.0018090104337738645],
                [0.0057031338926188495, 0.005703133892618858, -0.012920832232783789],
                [0.005703133892618859, -0.005703133892618848, -0.012920832232783782],
                [0.001253292450954325, -0.003951204725618206, -0.0018090104337738608],
                [-0.0012532924509543353, 0.003951204725618195, -0.0018090104337738764],
                [-0.005703133892618846, 0.0057031338926188495, -0.012920832232783792],
                [-0.00570313389261885, -0.005703133892618852, -0.012920832232783782],
                [-0.0012532924509543355, -0.003951204725618209, -0.0018090104337738727],
                [-0.0018346306568197395, 0.0018346306568197447, -0.0008638357043917359],
                [-0.003951204725618201, 0.0012532924509543325, -0.0018090104337738634],
                [-0.003951204725618204, -0.001253292450954331, -0.0018090104337738593],
                [
                    -0.0018346306568197358,
                    -0.0018346306568197456,
                    -0.0008638357043917384,
                ],
            ]
        )

        self.g = [
            [0, 0, 0],
            [0, 0, 0],
            [-0.0009020091985975408, -0.0004640758270369379, 0.0002075280720812311],
            [-0.0009112739142465167, -0.0006494853361845594, 0.0006350149813608834],
            [-0.0004640758270369379, -0.0009020091985975416, 0.00020752807208123194],
            [-0.0006494853361845594, -0.0009112739142465184, 0.0006350149813608827],
            [0.0010151027491997228, 0.0007577783406785823, -0.00019284180066040345],
            [0.001168802691321775, 0.0006283546431418985, -0.00046593369652421057],
            [0.0007577783406785839, 0.0010151027491997228, -0.00019284180066040114],
            [0.0006283546431419009, 0.001168802691321775, -0.00046593369652421057],
            [0.0006916430054476028, 0.0004997935030957185, -0.0006156854084533746],
            [0.0004997935030957096, 0.0006916430054476102, -0.0006156854084533746],
        ]

        self.dp1 = [
            0.0,
            0.0,
            -0.55,
            -0.55,
            -0.55,
            -0.55,
            1.55,
            1.55,
            1.55,
            1.55,
            1.0,
            1.0,
        ]

        self.sign = [
            0.0,
            0.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
        ]
        self.omega = [
            0,
            0,
            0.12642554943546536,
            0.1769356120134118,
            0.12642554943546536,
            0.1769356120134118,
            -0.09812663310653935,
            -0.11298429932899534,
            -0.09812663310653935,
            -0.11298429932899534,
            -0.09225022901334334,
            -0.09225022901334334,
        ]

        self.domega = [
            [0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0],
            [0.2687182648150743, -0.07665751307158719, -0.05350462044364246],
            [0.3432274471476974, -0.05829282450479467, -0.21763763582039528],
            [-0.07665751307158741, 0.2687182648150743, -0.05350462044364246],
            [-0.05829282450479467, 0.3432274471476974, -0.21763763582039528],
            [-0.05592673092636522, -0.08581853107054317, 0.020744480044006863],
            [-0.0774218075569843, -0.07798900910719636, 0.05680739937292439],
            [-0.08581853107054317, -0.05592673092636524, 0.020744480044006863],
            [-0.07798900910719636, -0.0774218075569843, 0.05680739937292439],
            [-0.10409453544578923, -0.0757447602795116, 0.006183714268686802],
            [-0.0757447602795116, -0.10409453544578923, 0.006183714268686802],
        ]

        self.pqr = [
            [0.11668845742152645, -0.11668845742152667, 0.0],
            [0.22767608713751997, -0.22767608713751974, 0.0],
            [-0.056535697417534725, 0.0, -0.24572925777377574],
            [-0.17299353519637528, 0.0, -0.24825319179068783],
            [0.0, 0.05653569741753495, 0.24572925777377597],
            [0.0, 0.17299353519637506, 0.24825319179068828],
            [0.0, -0.018641380526184248, -0.07325193165959926],
            [0.0, -0.045040272944634974, -0.06074096989391975],
            [0.018641380526184026, 0.0, 0.07325193165959942],
            [0.045040272944634974, 0.0, 0.06074096989391997],
            [-0.07488575250756935, 0.10363121290838628, 0.0],
            [-0.1036312129083874, 0.07488575250756802, 0.0],
        ]

        self.dpqr = [
            [
                [0.13771235651685973, -0.04908269734196688, 0.0],
                [0.04908269734196691, -0.13771235651685973, 0.0],
                [0.0, 0.0, 0.0],
            ],
            [
                [0.3880984592747866, -0.13832396523645257, 0.0],
                [0.1383239652364529, -0.3880984592747869, 0.0],
                [0.0, 0.0, 0.0],
            ],
            [
                [-0.10739277381881296, 0.0, -0.2725438537347513],
                [-0.05350462044364207, 0.0, -0.2687182648150745],
                [-0.19588634066316352, 0.0, 0.1073927738188132],
            ],
            [
                [-0.3004253144394277, 0.0, -0.1473411064845348],
                [-0.21763763582039547, 0.0, -0.3432274471476976],
                [-0.08904828197974063, -0.0, 0.3004253144394293],
            ],
            [
                [0.0, 0.05350462044364229, 0.2687182648150745],
                [0.0, 0.10739277381881329, 0.27254385373475076],
                [0.0, 0.19588634066316218, -0.1073927738188117],
            ],
            [
                [0.0, 0.21763763582039544, 0.3432274471476977],
                [0.0, 0.30042531443942855, 0.14734110648453436],
                [-0.0, 0.08904828197973935, -0.3004253144394276],
            ],
            [
                [0.0, -0.020744480044006947, -0.08581853107054299],
                [0.0, -0.01635534854816123, -0.0015780033914957747],
                [0.0, -0.057504734317860975, 0.01635534854816159],
            ],
            [
                [0.0, -0.0568073993729247, -0.07798900910719622],
                [0.0, -0.03098883252648965, 0.029831214957242905],
                [-0.0, -0.04759059259974122, 0.030988832526489644],
            ],
            [
                [0.01635534854816134, 0.0, 0.0015780033914960245],
                [0.020744480044006697, 0.0, 0.08581853107054341],
                [0.057504734317860844, 0.0, -0.016355348548161418],
            ],
            [
                [0.030988832526489485, 0.0, -0.02983121495724292],
                [0.05680739937292434, 0.0, 0.07798900910719639],
                [0.04759059259974108, -0.0, -0.030988832526489346],
            ],
            [
                [-0.0826684543040278, 0.024246493471415692, 0.0],
                [0.03043020774010244, 0.08266845430402806, 0.0],
                [0.07574476027951171, -0.1040945354457891, -0.0],
            ],
            [
                [-0.08266845430402814, -0.030430207740102383, 0.0],
                [-0.024246493471415803, 0.08266845430402817, 0.0],
                [0.10409453544579153, -0.07574476027950922, -0.0],
            ],
        ]

        self.edge_pqr = [
            [
                [0.6502768886521813, -0.6502768886521813, 0.0],
                [0.0, 0.5335884312306546, 0.0],
                [-0.5335884312306548, 0.0, 0.0],
            ],
            [
                [0.0, -0.877952975789701, 0.0],
                [0.8779529757897012, 0.0, 0.0],
                [-0.6502768886521813, 0.6502768886521813, 0.0],
            ],
            [
                [0.0, 0.0, 0.5756880205983905],
                [-0.877952975789701, 0.0, 0.0],
                [0.8214172783721663, 0.0, -0.8214172783721663],
            ],
            [
                [-0.8214172783721663, 0.0, 0.8214172783721663],
                [0.0, 0.0, -1.069670470162854],
                [0.648423743175791, 0.0, 0.0],
            ],
            [
                [0.0, -0.8214172783721663, 0.8214172783721663],
                [0.0, 0.8779529757897012, 0.0],
                [0.0, 0.0, -0.5756880205983903],
            ],
            [
                [0.0, -0.6484237431757912, 0.0],
                [0.0, 0.0, 1.0696704701628545],
                [0.0, 0.8214172783721663, -0.8214172783721663],
            ],
            [
                [0.0, 0.0, 0.4416951190448713],
                [0.0, -0.5335884312306548, 0.0],
                [0.0, 0.5149470507044706, -0.5149470507044706],
            ],
            [
                [0.0, -0.5149470507044706, 0.5149470507044706],
                [0.0, 0.0, -0.5756880205983903],
                [0.0, 0.4699067777598356, 0.0],
            ],
            [
                [-0.5149470507044706, 0.0, 0.5149470507044706],
                [0.5335884312306546, 0.0, 0.0],
                [0.0, 0.0, -0.44169511904487113],
            ],
            [
                [-0.4699067777598356, 0.0, 0.0],
                [0.0, 0.0, 0.5756880205983905],
                [0.5149470507044706, 0.0, -0.5149470507044706],
            ],
            [
                [0.0, -0.4699067777598356, 0.0],
                [-0.6484237431757912, 0.0, 0.0],
                [0.5735379906682219, 0.5735379906682219, 0.0],
            ],
            [
                [-0.573537990668223, -0.573537990668223, 0.0],
                [0.0, 0.648423743175791, 0.0],
                [0.4699067777598356, 0.0, 0.0],
            ],
        ]

        self.edge_dpqr = [
            [
                [
                    [0.28953233348118146, -0.28953233348118146, 0.0],
                    [0.28953233348118157, -0.28953233348118157, 0.0],
                    [0.0, -0.0, 0.0],
                ],
                [
                    [0.0, 0.24044963613921458, 0.0],
                    [0.0, 0.15181997696432184, 0.0],
                    [0.0, 0.0, 0.0],
                ],
                [
                    [-0.15181997696432173, 0.0, 0.0],
                    [-0.24044963613921466, 0.0, 0.0],
                    [-0.0, 0.0, 0.0],
                ],
            ],
            [
                [
                    [0.0, -0.42785629871763414, 0.0],
                    [0.0, -0.6776307927559684, 0.0],
                    [0.0, -0.0, 0.0],
                ],
                [
                    [0.6776307927559682, 0.0, 0.0],
                    [0.42785629871763436, 0.0, 0.0],
                    [0.0, 0.0, 0.0],
                ],
                [
                    [-0.28953233348118157, 0.28953233348118157, 0.0],
                    [-0.28953233348118146, 0.28953233348118146, 0.0],
                    [-0.0, 0.0, 0.0],
                ],
            ],
            [
                [
                    [0.0, 0.0, 0.2976941652024041],
                    [0.0, 0.0, 0.10563341345891758],
                    [-0.0, -0.0, -0.08849356684435032],
                ],
                [
                    [-0.6776307927559684, 0.0, 0.0],
                    [-0.42785629871763414, 0.0, 0.0],
                    [-0.0, 0.0, 0.0],
                ],
                [
                    [0.5702380189371554, 0.0, -0.5702380189371554],
                    [0.3743516782739921, 0.0, -0.3743516782739921],
                    [-0.19588634066316352, -0.0, 0.19588634066316352],
                ],
            ],
            [
                [
                    [-0.5702380189371549, 0.0, 0.5702380189371549],
                    [-0.3743516782739921, 0.0, 0.3743516782739921],
                    [0.19588634066316218, -0.0, -0.19588634066316218],
                ],
                [
                    [0.0, 0.0, -0.7175791254216897],
                    [0.0, 0.0, -0.7175791254216897],
                    [-0.0, -0.0, 0.4963116551025915],
                ],
                [
                    [0.26981270449772715, 0.0, 0.0],
                    [0.1567140424535966, 0.0, 0.0],
                    [-0.2849346226429028, -0.0, -0.0],
                ],
            ],
            [
                [
                    [0.0, -0.3743516782739921, 0.3743516782739921],
                    [0.0, -0.5702380189371549, 0.5702380189371549],
                    [-0.0, 0.19588634066316218, -0.19588634066316218],
                ],
                [
                    [0.0, 0.42785629871763436, 0.0],
                    [0.0, 0.6776307927559682, 0.0],
                    [0.0, 0.0, 0.0],
                ],
                [
                    [0.0, 0.0, -0.1056334134589176],
                    [0.0, 0.0, -0.2976941652024041],
                    [-0.0, -0.0, 0.08849356684435049],
                ],
            ],
            [
                [
                    [0.0, -0.15671404245359663, 0.0],
                    [0.0, -0.2698127044977269, 0.0],
                    [-0.0, 0.28493462264290287, -0.0],
                ],
                [
                    [0.0, 0.0, 0.7175791254216898],
                    [0.0, 0.0, 0.7175791254216898],
                    [-0.0, -0.0, -0.4963116551025911],
                ],
                [
                    [0.0, 0.3743516782739921, -0.3743516782739921],
                    [0.0, 0.5702380189371554, -0.5702380189371554],
                    [-0.0, -0.19588634066316352, 0.19588634066316352],
                ],
            ],
            [
                [
                    [0.0, 0.0, 0.13388662502466472],
                    [0.0, 0.0, 0.13388662502466472],
                    [-0.0, -0.0, -0.041149385769699384],
                ],
                [
                    [0.0, -0.24044963613921466, 0.0],
                    [0.0, -0.15181997696432173, 0.0],
                    [0.0, -0.0, 0.0],
                ],
                [
                    [0.0, 0.21970515609520772, -0.21970515609520772],
                    [0.0, 0.1354646284161605, -0.1354646284161605],
                    [-0.0, -0.057504734317860975, 0.057504734317860975],
                ],
            ],
            [
                [
                    [0.0, -0.21970515609520788, 0.21970515609520788],
                    [0.0, -0.1354646284161605, 0.1354646284161605],
                    [-0.0, 0.057504734317860844, -0.057504734317860844],
                ],
                [
                    [0.0, 0.0, -0.2976941652024041],
                    [0.0, 0.0, -0.1056334134589176],
                    [-0.0, -0.0, 0.08849356684435049],
                ],
                [
                    [0.0, 0.16289775672228318, 0.0],
                    [0.0, 0.10447579588967085, 0.0],
                    [-0.0, -0.10509532691760207, -0.0],
                ],
            ],
            [
                [
                    [-0.1354646284161605, 0.0, 0.1354646284161605],
                    [-0.21970515609520788, 0.0, 0.21970515609520788],
                    [0.057504734317860844, -0.0, -0.057504734317860844],
                ],
                [
                    [0.15181997696432184, 0.0, 0.0],
                    [0.24044963613921458, 0.0, 0.0],
                    [0.0, 0.0, 0.0],
                ],
                [
                    [0.0, 0.0, -0.13388662502466447],
                    [0.0, 0.0, -0.13388662502466447],
                    [-0.0, -0.0, 0.041149385769699426],
                ],
            ],
            [
                [
                    [-0.10447579588967101, 0.0, 0.0],
                    [-0.16289775672228338, 0.0, 0.0],
                    [0.10509532691760205, -0.0, -0.0],
                ],
                [
                    [0.0, 0.0, 0.10563341345891758],
                    [0.0, 0.0, 0.2976941652024041],
                    [-0.0, -0.0, -0.08849356684435032],
                ],
                [
                    [0.1354646284161605, 0.0, -0.1354646284161605],
                    [0.21970515609520772, 0.0, -0.21970515609520772],
                    [-0.057504734317860975, -0.0, 0.057504734317860975],
                ],
            ],
            [
                [
                    [0.0, -0.16289775672228338, 0.0],
                    [0.0, -0.10447579588967101, 0.0],
                    [-0.0, 0.10509532691760205, -0.0],
                ],
                [
                    [-0.2698127044977269, 0.0, 0.0],
                    [-0.15671404245359663, 0.0, 0.0],
                    [0.28493462264290287, -0.0, -0.0],
                ],
                [
                    [0.18714425019369907, 0.18714425019369907, 0.0],
                    [0.18714425019369907, 0.18714425019369907, 0.0],
                    [-0.20918986236339115, -0.20918986236339115, -0.0],
                ],
            ],
            [
                [
                    [-0.18714425019369899, -0.18714425019369899, 0.0],
                    [-0.18714425019369899, -0.18714425019369899, 0.0],
                    [0.2091898623633936, 0.2091898623633936, -0.0],
                ],
                [
                    [0.0, 0.1567140424535966, 0.0],
                    [0.0, 0.26981270449772715, 0.0],
                    [-0.0, -0.2849346226429028, -0.0],
                ],
                [
                    [0.10447579588967085, 0.0, 0.0],
                    [0.16289775672228318, 0.0, 0.0],
                    [-0.10509532691760207, -0.0, -0.0],
                ],
            ],
        ]

        self.simplices = [
            [3, 1, 2],
            [3, 0, 1],
            [5, 1, 0],
            [5, 0, 4],
            [7, 0, 3],
            [7, 4, 0],
            [6, 2, 1],
            [6, 1, 5],
            [6, 3, 2],
            [6, 7, 3],
            [6, 5, 4],
            [6, 4, 7],
        ]

        self.un = [
            [-0.0, -0.0, 1.0],
            [-0.0, -0.0, 1.0],
            [0.0, -1.0, 0.0],
            [-0.0, -1.0, -0.0],
            [-1.0, -0.0, 0.0],
            [-1.0, 0.0, 0.0],
            [1.0, 0.0, -0.0],
            [1.0, -0.0, -0.0],
            [0.0, 1.0, -0.0],
            [0.0, 1.0, 0.0],
            [0.0, -0.0, -1.0],
            [-0.0, -0.0, -1.0],
        ]

        self.tensor = [
            [
                [0.0, 0.0, -7.787880999078628],
                [0.0, 0.0, -7.787880999078613],
                [-7.787880999078628, -7.787880999078613, -0.0],
            ],
            [
                [0.0, 0.0, -15.19528419642778],
                [0.0, 0.0, -15.195284196427794],
                [-15.19528419642778, -15.195284196427794, -0.0],
            ],
            [
                [-10.004387158337162, 6.536207664624554, 3.9421138013876567],
                [6.536207664624554, 11.251643371387011, 1.9640176446577793],
                [3.9421138013876567, 1.9640176446577793, 7.190486096712636],
            ],
            [
                [-5.4085148258146525, 3.9696157001366563, 11.027844204266438],
                [3.9696157001366563, 13.948604652204995, 7.9889204586190115],
                [11.027844204266438, 7.9889204586190115, 3.2687344678743617],
            ],
            [
                [11.251643371387019, -9.863959582603453, 1.9640176446577793],
                [-9.863959582603453, -10.00438715833714, 3.942113801387602],
                [1.9640176446577793, 3.942113801387602, 7.190486096712587],
            ],
            [
                [13.948604652204995, -12.599000922527274, 7.9889204586190115],
                [-12.599000922527274, -5.408514825814673, 11.027844204266488],
                [7.9889204586190115, 11.027844204266488, 3.268734467874413],
            ],
            [
                [-0.7635281115508694, 8.877775998633009, -2.145979950267633],
                [8.877775998633009, 0.16324167356426889, -1.6919320218938723],
                [-2.145979950267633, -1.6919320218938723, -5.948763556850319],
            ],
            [
                [0.46848720473211364, 8.067825731483437, -5.876625484106133],
                [8.067825731483437, -3.085986684388456, -3.2057401845200766],
                [-5.876625484106133, -3.2057401845200766, -4.9231630450002415],
            ],
            [
                [0.16324167356426889, 3.9888834781260245, -1.6919320218938585],
                [3.9888834781260245, -0.7635281115508675, -2.145979950267633],
                [-1.6919320218938585, -2.145979950267633, -5.948763556850305],
            ],
            [
                [-3.085986684388454, 4.013924807987302, -3.2057401845201072],
                [4.013924807987302, 0.46848720473211364, -5.876625484106133],
                [-3.2057401845201072, -5.876625484106133, -4.923163045000253],
            ],
            [
                [1.6182303714770736, 5.517358775014287, -0.030922516804293126],
                [5.517358775014287, -2.0309364087406307, -0.057330865905662186],
                [-0.030922516804293126, -0.057330865905662186, -5.744148047270174],
            ],
            [
                [-2.030936408740629, 5.51735877501426, -0.05733086590565108],
                [5.51735877501426, 1.6182303714770605, -0.030922516804294052],
                [-0.05733086590565108, -0.030922516804294052, -5.744148047270174],
            ],
        ]

        self.T = [
            [6.156854084533704, 24.0259904258888, -11.0688001100732],
            [24.0259904258888, 6.156854084533683, -11.068800110073198],
            [-11.0688001100732, -11.068800110073198, -12.313708169067468],
        ]


@pytest.fixture
def cube():
    return Cube()


@pytest.fixture
def expected():
    return CubeExcepted()
